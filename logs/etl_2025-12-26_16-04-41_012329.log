2025-12-26 16:04:41.013 | INFO     | config.logging_config:setup_logging:25 - Logging setup complete.
2025-12-26 16:04:41.015 | INFO     | __main__:main:20 - Starting ETL Pipeline in 'full' mode...
2025-12-26 16:04:41.015 | INFO     | __main__:main:30 - >>> Step 1: Data Ingestion
2025-12-26 16:04:41.016 | INFO     | src.ingestion.csv_loader:load_and_convert:44 - CSV version already exists at C:\Users\MSI\Desktop\FinanceETLHub\data\raw\online_retail.csv. Loading...
2025-12-26 16:04:41.574 | INFO     | src.ingestion.csv_loader:get_data:56 - Loaded dataset with 541909 rows.
2025-12-26 16:04:41.575 | INFO     | src.ingestion.fx_api:get_rates:32 - Fetching FX rates from API for GBP...
2025-12-26 16:04:42.904 | ERROR    | src.ingestion.fx_api:get_rates:50 - FX API request failed: 404 Client Error: Not Found for url: https://v6.exchangerate-api.com/v6/your_api_key_here/latest/GBP. Falling back to mock data.
2025-12-26 16:04:42.906 | INFO     | __main__:main:43 - >>> Step 2: Data Transformation
2025-12-26 16:04:43.959 | INFO     | src.transformation.cleaner:clean:43 - Cleaning complete. Rows: 541909 -> 392692 (Dropped 149217)
2025-12-26 16:04:44.173 | INFO     | src.transformation.currency:transform:27 - Currency transformation applied for: ['GBP', 'USD', 'EUR', 'MAD']
2025-12-26 16:04:44.774 | INFO     | src.transformation.rfm:generate_segments:83 - RFM Segmentation complete.
2025-12-26 16:04:44.831 | INFO     | src.transformation.fraud:detect:16 - Starting Advanced Fraud Detection Analysis...
2025-12-26 16:04:45.148 | INFO     | src.transformation.fraud:detect:45 - Fraud Analysis Complete: Flagged 24645 suspicious transactions.
2025-12-26 16:04:45.149 | INFO     | src.transformation.fraud:detect:46 -  - Value Outliers (> 64.35 GBP): 20852
2025-12-26 16:04:45.150 | INFO     | src.transformation.fraud:detect:47 -  - Price Anomalies: 3241
2025-12-26 16:04:45.150 | INFO     | src.transformation.fraud:detect:48 -  - High Velocity Invoices: 675
2025-12-26 16:04:45.151 | INFO     | src.quality.checks:run_checks:13 - Running Advanced Data Quality Suite...
2025-12-26 16:04:45.303 | WARNING  | src.quality.checks:run_checks:30 - DQ Warning: Found 4851 duplicate product entries within invoices. This might be normal but warrants review.
2025-12-26 16:04:45.312 | INFO     | src.quality.checks:run_checks:55 - âœ… All critical Data Quality Checks Passed.
2025-12-26 16:04:45.313 | INFO     | __main__:main:76 - >>> Step 3: Data Warehouse Loading
2025-12-26 16:04:45.407 | INFO     | src.warehouse.loader:init_db:16 - Initializing Data Warehouse Schema...
2025-12-26 16:04:45.557 | INFO     | src.warehouse.loader:load_dimensions:27 - Loading DimProduct...
2025-12-26 16:04:45.899 | INFO     | src.warehouse.loader:load_dimensions:43 - Inserted 3665 new products.
2025-12-26 16:04:45.900 | INFO     | src.warehouse.loader:load_dimensions:47 - Loading DimCustomer with RFM segments...
2025-12-26 16:04:46.356 | INFO     | src.warehouse.loader:load_dimensions:77 - Inserted 4338 new customers.
2025-12-26 16:04:46.357 | INFO     | src.warehouse.loader:load_facts:89 - Loading FactSales...
2025-12-26 16:05:20.057 | INFO     | src.warehouse.loader:load_facts:109 - Loaded 392692 sales records.
2025-12-26 16:05:20.263 | SUCCESS  | __main__:main:86 - ETL Pipeline Completed Successfully!
